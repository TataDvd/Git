using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Tempo2012.EntityFramework;

namespace Tempo2012.UI.WPF.ViewModels.Deklar
{
    public class DeklarviewModel
    {
        public static string ReturnDeklar(Dictionary<string, string> declar)
        {
            StringBuilder sb=new StringBuilder();
            sb.AppendLine("Приложение N13 към чл.116 ал.1 на ППЗДДС");
            sb.AppendLine("                                                                  +------------------------------------+");
            sb.AppendLine("               С П Р А В К А -  Д Е К Л А Р А Ц И Я               |ТД на НАП/офис                      |");
            sb.AppendLine("                ЗА ДАНЪК ВЪРХУ ДОБАВЕНАТА СТОЙНОСТ                |                                    |");
            sb.AppendLine("                                                                  |Входящ номер:            /        г.|");
            sb.AppendLine("                                                                  +------------------------------------+");
            sb.AppendLine("                                                                  попълва се от приходната администрация");
            sb.AppendFormat("+----------------------------------------------------------+     Данъчен период:   {0,8}",declar["data"]);
            sb.AppendLine();
            sb.AppendLine("|А. Наименование и адрес за кореспонденция на регист.лице  |                       ММ/ГГГГ");
            sb.AppendLine("|----------------------------------------------------------|");
            sb.AppendFormat("|{0,-58}|",declar["firma"]);
            sb.AppendLine();
            sb.AppendFormat("|{0,-58}|      +------------------------------------+", declar["adress"]);
            sb.AppendLine();
            sb.AppendFormat("|                                                          |      | ИН по ЗДДС:     {0,15}    |", declar["dds"]);
            sb.AppendLine();
            sb.AppendFormat("|тел. {0,14}                                       |      +------------------------------------+", declar["tel"]);
            sb.AppendLine();
            sb.AppendFormat("|                                                          |      | ИН:{0,15}                 |", declar["iddds"]);
            sb.AppendLine();
            sb.AppendLine("+----------------------------------------------------------+      +------------------------------------+");
            sb.AppendLine("--------------------------------------------------------------------------------------------------------");
            sb.AppendLine(" Раздел А: Данни за начислен данък върху добавената стойност");
            sb.AppendLine("                                 +---------------+--+                                +---------------+--+");
            sb.AppendFormat(" Общ размер на данъчните основи  |{0,15}|01| Всичко начислен ДДС            |{1,15}|20|", declar["kl01"], declar["kl20"]);
            sb.AppendLine();
            sb.AppendLine(" за облагане с ДДС               +---------------+--+ (сума от кл.21 до кл.24)       +---------------+--+");
            sb.AppendLine("");
            sb.AppendLine(" Данъчна основа, подлежаща на облагане със ставка 20%:");
            sb.AppendLine(" -данъчна основа на облагаемите  +---------------+--+                                +---------------+--+");
            sb.AppendFormat(" доставки,вкл.дост.при условията |{0,15}|11| Начислен ДДС                   |{1,15}|21|",declar["kl11"], declar["kl21"]);
            sb.AppendLine();
            sb.AppendLine(" на дистанц.продажби с място на  +---------------+--+                                +---------------+--+");
            sb.AppendLine(" изпълн.на територ.на страната");
            sb.AppendLine(" -данъчна основа на ВОП и дан.   +---------------+--+                                +---------------+--+");
            sb.AppendFormat(" основа на получ.доставки по     |{0,15}|12| Начислен ДДС за ВОП и за получ.|{1,15}|22|",declar["kl12"], declar["kl22"]);
            sb.AppendLine();
            sb.AppendLine(" чл. 82, ал.2-5 ЗДДС             +---------------+--+ дост.по чл.82,ал. 2-5 ЗДДС     +---------------+--+");
            sb.AppendLine("                                                                                     +---------------+--+");
            sb.AppendFormat("                                                 Начислен данък за доставки на стоки |{0,15}|23|", declar["kl23"]);
            sb.AppendLine();
            sb.AppendLine("                                                   и услуги за лични нужди****       +---------------+--+");
            sb.AppendLine(" Данъчна основа на облагаемите   +---------------+--+                                +---------------+--+");
            sb.AppendFormat(" доставки със ставка   9 %       |{0,15}|13| Начислен ДДС   (9 %)           |{1,15}|24|", declar["kl13"], declar["kl24"]);
            sb.AppendLine();
            sb.AppendLine("                                 +---------------+--+                                +---------------+--+");
            sb.AppendLine(" Данъчна основа, подлежаща на облагане със ставка 0%:");
            sb.AppendLine(" -данъчна основа за доставки по  +---------------+--+");
            sb.AppendFormat(" глава трета от ЗДДС             |{0,15}|14|", declar["kl14"]);
            sb.AppendLine();
            sb.AppendLine("                                 +---------------+--+");
            sb.AppendLine(" -данъчна основа на ВОД на       +---------------+--+");
            sb.AppendFormat(" стоки                           |{0,15}|15|", declar["kl15"]);
            sb.AppendLine();
            sb.AppendLine("                                 +---------------+--+");
            sb.AppendLine(" -данъчна основа на доставки по  +---------------+--+");
            sb.AppendFormat(" чл.140,146 и чл.173,ал.1и4 ЗДДС*|{0,15}|16|", declar["kl16"]);
            sb.AppendLine();
            sb.AppendLine("                                 +---------------+--+");
            sb.AppendLine(" -данъчна основа на доставки на  +---------------+--+");
            sb.AppendFormat(" услуги по чл.21 ал.2 с място    |{0,15}|17|", declar["kl17"]);
            sb.AppendLine();
            sb.AppendLine(" на изпълн.терит.на др.          +---------------+--+");
            sb.AppendLine(" държ.членка");
            sb.AppendLine(" -данъчна основа на доставки по  +---------------+--+");
            sb.AppendFormat(" чл.69,ал.2 ЗДДС,вкл.доставките**|{0,15}|18|", declar["kl18"]);
            sb.AppendLine();
            sb.AppendLine(" при услов.на дистанц.продажби с +---------------+--+");
            sb.AppendLine(" място на изпълн. на територ.");
            sb.AppendLine(" на др.държава членка,както и на доставки като посредник в тристранна операция");
            sb.AppendLine(" -данъчна основа на освободените +---------------+--+");
            sb.AppendFormat(" доставки и освободените ВОП***  |{0,15}|19|", declar["kl19"]);
            sb.AppendLine();
            sb.AppendLine("                                 +---------------+--+");
            sb.AppendLine("---------------------------------------------------------------------------------------------------------");
            sb.AppendLine(" Раздел Б: Данни за упражнено право на данъчен кредит");
            sb.AppendLine(" Данъчна основа и данък на получе-+--------------+--+");
            sb.AppendFormat(" ните доставки,ВОП,получените     |{0,14}|30|", declar["kl30"]);
            sb.AppendLine();
            sb.AppendLine(" доставки по чл.82,ал.2-5         +--------------+--+");
            sb.AppendLine(" ЗДДС и вноса без право на данъчен");
            sb.AppendLine(" кредит или без данък");
            sb.AppendLine(" Данъчна основа на получените дос-");
            sb.AppendLine(" тавки,ВОП,получените доставки по");
            sb.AppendLine(" чл.82,ал.2-5 ЗДДС,вноса,както и");
            sb.AppendLine(" данъчна основа на получените");
            sb.AppendLine(" доставки,използвани за извършване");
            sb.AppendLine(" на доставки по чл.69,ал.2 ЗДДС:");
            sb.AppendLine(" - с право на пълен данъчен       +--------------+--+ ДДС с право на пълен данъчен   +---------------+--+");
            sb.AppendFormat(" кредит                           |{0,14}|31| кредит                         |{1,15}|41|",declar["kl31"],declar["kl41"]);
            sb.AppendLine();
            sb.AppendLine("                                  +--------------+--+                                +---------------+--+");
            sb.AppendLine(" - с право на частичен данъчен    +--------------+--+ ДДС с право на частичен        +---------------+--+");
            sb.AppendFormat(" кредит                           |{0,14}|32| данъчен кредит                 |{1,15}|42|",declar["kl32"],declar["kl42"]);
            sb.AppendLine();
            sb.AppendLine("                                  +--------------+--+                                +---------------+--+");
            sb.AppendLine("                                                      Годишна корекция по чл.73,ал.8 +---------------+--+");
            sb.AppendFormat("                                                      (+/-)                          |{0,15}|43|",declar["kl43"]);
            sb.AppendLine();
            sb.AppendLine("                                                                                     +---------------+--+");
            sb.AppendLine(" Коефициент по чл.73, ал.5 ЗДДС   +--------------+--+ Общо данъчен кредит            +---------------+--+");
            sb.AppendFormat("                                  |{0,14}|33| (кл.41+кл.42*кл.33+кл.43)      |{1,15}|40|", declar["kl33"], declar["kl40"]);
            sb.AppendLine();
            sb.AppendLine("                                  +--------------+--+                                +---------------+--+");
            sb.AppendLine("---------------------------------------------------------------------------------------------------------");
            sb.AppendLine(" Раздел В: Резултат за периода    +--------------+--+                                +---------------+--+");
            sb.AppendFormat(" ДДС за внасяне                   |{0,14}|50|    ДДС за възстановяване       |{1,15}|60|", declar["kl50"], declar["kl60"]);
            sb.AppendLine();
            sb.AppendLine("    (кл.20-кл.40) >= 0            +--------------+--+          (кл.20-кл.40) < 0     +---------------+--+");
            sb.AppendLine("---------------------------------------------------------------------------------------------------------");
            sb.AppendLine(" Раздел Г: ДДС за внасяне         +--------------+--+                                +---------------+--+");
            sb.AppendFormat(" Данък за внасяне от кл.50 приспад|{0,14}|70| Данък за внасяне от кл.50,     |{1,15}|71|", declar["kl70"], declar["kl71"]);
            sb.AppendLine();
            sb.AppendLine(" нат по реда на чл.92 ал.1 от ЗДДС+--------------+--+ внесен ефективно               +---------------+--+");
            sb.AppendLine("--------------------------------------------------------------------------------------------------------");
            sb.AppendLine(" Раздел Д: ДДС,подлежащ на възстановяване");
            sb.AppendLine("Съгл.чл.92,ал.1 ЗДДС+-----------+--+Съгл.чл.92ал.3 ЗДДС+-----------+--+Съгл.чл.92ал.4 ЗДДС+-----------+--");
            sb.AppendFormat("в 30-дневен срок от |{0,11}|80|в 30-дневен срок от|{1,11}|81|в 30-дневен срок от|{2,11}|82", declar["kl80"], declar["kl81"], declar["kl82"]);
            sb.AppendLine();
            sb.AppendLine(" подаването на      +-----------+--+ подаването на     +-----------+--+ подаването на     +-----------+--");
            sb.AppendLine(" тази декларация                     тази декларация                    тази декларация");
            sb.AppendLine("--------------------------------------------------------------------------------------------------------");
            sb.AppendFormat("Долуподписаният: {0}    ",declar["mol"]);
            sb.AppendLine("декларирам,че:");
            sb.AppendFormat("({0})   представлявам лицето,посочено в кл.А и посочената в този формуляр информация е вярна и точна.", declar["pr"]); sb.AppendLine();
            sb.AppendFormat("({0})   са налице обстоятелствата по чл.92, ал.3 и 4 ЗДДС.", declar["kl"]); sb.AppendLine();
            sb.AppendLine("      Известно ми е, че за неверни данни нося отговорност по чл.313 НК.");
            sb.AppendLine("");
            sb.AppendFormat("{0,8}     {1,20}", declar["DateTimeNow"], declar["dl"]);
            sb.AppendLine();
            sb.AppendLine("(дата на съставяне)      (длъжност)                           (подпис и печат)");
            sb.AppendLine();
            sb.AppendLine("Забележка.Този формуляр се попълва задължително на машина.Стойностите се посочват в левове и стотинки.");
            sb.AppendLine("* В клетка 16 се декларират доставки, за които се прилага нулева ставка на данъка:");
            sb.AppendLine("  -доставки на обща туристическа услуга в случаите, когато доставките на стоките и услугите, от които"); 
            sb.AppendLine("   пътуващото лице се възползва пряко, са с място на изпълнение на територията на трети страни и територии;");
            sb.AppendLine("  -доставки на стоки по специалния ред на облагане на маржа, когато за доставките са налице условията на чл. ");
            sb.AppendLine("   28 ЗДДС;");
            sb.AppendLine("  -освободени доставки по силата на международни договори;");
            sb.AppendLine("  -доставки, по които получатели са въоръжените сили на други държави, които са страни по Северноатлантическия");
            sb.AppendLine("   договор или институции на Европейския съюз.");
            sb.AppendLine("**В клетка 18 се декларират доставките с място на изпълнение извън територията на страната, които биха били"); 
            sb.AppendLine("   облагаеми, ако бяха извършени на територията");
            sb.AppendLine("   на страната, както и доставките на финансови услуги и на застрахователни услуги, когато получателят на"); 
            sb.AppendLine("   услугите е установен извън Европейския съюз"); 
            sb.AppendLine("   или когато са пряко свързани със стоки, за които са изпълнени условията на чл. 28 ЗДДС.");
            sb.AppendLine("***В клетка 19 не се декларират доставките на финансови услуги и на застрахователни услуги, когато получателят е"); 
            sb.AppendLine("   установен извън Европейския съюз или"); 
            sb.AppendLine("   когато са пряко свързани със стоки, за които са изпълнени условията на чл. 28 ЗДДС, които са приравнени на ");
            sb.AppendLine("   облагаеми по смисъла на чл. 69, ал. 2 ЗДДС и се декларират в клетка 18.");
            sb.AppendLine("****В клетка 23 се декларира дължимият данък за използваните през данъчния период стоки и услуги за лични нужди.");

            return sb.ToString();
        }
        public static string ReturnViesDeclar(Dictionary<string, string> declar, List<ViesRow> list)
        {
            StringBuilder sb=new StringBuilder();
            sb.AppendLine("                                                      Приложение N14 към чл.117 ал.1 на ППЗДДС");
            sb.AppendLine("                                                +--------------------------------------------+");
            sb.AppendLine("               VIES - ДЕКЛАРАЦИЯ                | ТД /офис ................................. |");
            sb.AppendLine("                                                |  ......................................... |");
            sb.AppendLine("                                                | Входящ номер:            /        г.       |");
            sb.AppendLine("                                                +--------------------------------------------+");
            sb.AppendLine("                                                | попълва се от приходната администрация     |");
            sb.AppendLine("                                                +--------------------------------------------+");
          sb.AppendFormat("                                                |  Данъчен период:   {0,8}            |",declar["data"]);sb.AppendLine();
            sb.AppendLine("                                                |                     мм/гггг                |");
            sb.AppendLine("+-----------------------------------------------+--------------------------------------------+");
            sb.AppendLine("|А. Данни за регистрираното лице                                                             |");
            sb.AppendLine("+--------------------------------------------------------------------------------------------+");
          sb.AppendFormat("| Идентификационен номер по ДДС {0,-61}|",declar["dds"]);sb.AppendLine();
          sb.AppendFormat("| Име/наименование {0,-74}|",declar["firma"]);sb.AppendLine();
          sb.AppendFormat("| Адрес за кореспонденция {0,-67}|",declar["address"]);sb.AppendLine();
            sb.AppendLine("+--------------------------------------------------------------------------------------------+");
            sb.AppendLine("+--------------------------------------------------------------------------------------------+");
            sb.AppendLine("|Б. Данни за лицето, подаващо декларацията                                                   |");
            sb.AppendLine("+--------------------------------------------------------------------------------------------+");
          sb.AppendFormat("| Име {0,-87}|",declar["mol"]);sb.AppendLine();
          sb.AppendFormat("| ЕГН/ЛНЧ/Сл.номер от регистъра на НАП  {0,-53}|",declar["egn"]);sb.AppendLine();
            sb.AppendLine("| Адрес за кореспонденция:                                                                   |");
          sb.AppendFormat("|   кв.,ЖК, ул.No {0,-75}|",declar["address1"]);sb.AppendLine();
          sb.AppendFormat("|   населено място (гр./с.) {0,-65}|",declar["city"]);sb.AppendLine();
          sb.AppendFormat("|   пощенски код {0,4}                                                                        |",declar["zip"]);sb.AppendLine();
          sb.AppendFormat("| В качеството на                   ({0}) представляващ                   ({1}) пълномощник      |", declar["p"], declar["pr"]);sb.AppendLine();
            sb.AppendLine("+--------------------------------------------------------------------------------------------+");
            sb.AppendLine("+--------------------------------------------------------------------------------------------+");
            sb.AppendLine("| В. Извършени вътреобщностни доставки на стоки, доставки на стоки като посредник в          |");
            sb.AppendLine("| тристранна операция, както и доставка на услуги по чл.21,ал.2 ЗДДС с място на              |");
            sb.AppendLine("| изпълнение на територията на друга държава членка,по които получатели са данъчно задължени |");
            sb.AppendLine("| регистрирани за  целите на ДДС лица в друга държава членка                                 |");
            sb.AppendLine("+-----------------------------------------------------------------+----------------------+---+");
            sb.AppendFormat("| Данъчна основа - общо(лв.)(сума на колона к3+к4+к5)в това число |{0,22}| 01|", declar["sumak1k2k3"]);sb.AppendLine();
            sb.AppendLine("+-----------------------------------------------------------------+----------------------+---+");
          sb.AppendFormat("| данъчна основа на ВОД                                           |{0,22}|   |",declar["sumak3"]);sb.AppendLine();
            sb.AppendLine("| (сума на колона к.3)                                            |                      | 17|");
            sb.AppendLine("+-----------------------------------------------------------------+----------------------+---+");
          sb.AppendFormat("| Общ брой редове в декларацията                                  |{0,22}| 02|",declar["count"]);sb.AppendLine();
            sb.AppendLine("+-----------------------------------------------------------------+----------------------+---+");
            sb.AppendLine("+---+---------------+--------------------------------------------------------+---------------+");
            sb.AppendLine("|No | ИН по ДДС на  |             Данъчна основа в лв.                       |   Данъчен     |");
            sb.AppendLine("|на | получателя/   +------------------+------------------+------------------+   период,     |");
            sb.AppendLine("|ред|придобиващия   | вътреобщностни   |  доставки  на    |доставка на услуги|   през който  |");
            sb.AppendLine("|   | (вкл.знака)   | доставки на      |  стоки като      |по чл.21 ал 2 ЗДДС|   данъкът е   |");
            sb.AppendLine("|   |               |    стоки         |  посредник в     |с място на изпълн |   станал      |");
            sb.AppendLine("|   |               |                  |  тристранна      |на терит.на др.   |   изискуем    |");
            sb.AppendLine("|   |               |                  |  операция        |държ.членка       |   (мм/гггг)   |");
            sb.AppendLine("|   |               |                  |                  |                  |               |");
            sb.AppendLine("+---+---------------+------------------+------------------+------------------+---------------+");
            sb.AppendLine("| к1|      к2       |        к3        |       к4         |        к5        |        к6     |");
            sb.AppendLine("+---+---------------+------------------+------------------+------------------+---------------+");
            foreach (var l in list)
            {
                sb.AppendFormat("|{0,3}|{1,-15}|{2,18}|{3,18}|{4,18}|{5,15}|",l.PorNom,l.Name,l.K3,l.K4,l.K5," ");
                sb.AppendLine();
            }
            sb.AppendLine("---------------------------------------------------------------------------------------------+");
            sb.AppendLine("*В колона к.6 се вписва данъчният период, през който данъкът е станал изискуем, в случаите,   ");
            sb.AppendLine("когато този период е различен от данъчния период, за който се отнася тази декларация.         ");
            sb.AppendFormat("Долуподписаният: {0,-50}                                                      ",declar["mol"]);
            sb.AppendLine();
            sb.AppendLine("декларирам,че представлявам лицето,посочено в кл.А и посочената в този формуляр информация е  ");
            sb.AppendLine("вярна и точна. Известно ми е, че за неверни данни нося отговорност по чл.313 НК.              ");
            sb.AppendLine("                                                                                              ");
            sb.AppendLine("                                                                                              ");
            sb.AppendLine("................................................                                              ");
            sb.AppendLine("                                                              (подпис и печат)                ");
            sb.AppendLine("                                                                                              ");
            sb.AppendLine(" Забележка: Този формуляр се попълва задължително на машина. Стойностите се посочват          ");
            sb.AppendLine(" в левове и стотинки.                                                                         ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("УКАЗАНИЯ:                                                                                     ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("А. Данни за регистрираното лице                                                               ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("Идентификационен номер по ДДС  ------------------ ЗДДС Номер от Данните на фирмата-основни дан");
            //sb.AppendLine("Име/наименование      --------------------------- фирма от Данните на фирмата-основни данни   ");
            //sb.AppendLine("Адрес за кореспонденция   ----------------------- адрес от Данните на фирмата-основни данни   ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("Б. Данни за лицето, подаващо декларацията                                                     ");
            //sb.AppendLine("Име  -------------------------------------------- Имена от данни за представляващия           ");
            //sb.AppendLine("ЕГН/ЛНЧ/Сл.номер от регистъра на НАП  ----------- ЕГН от данни за представляващия             ");
            //sb.AppendLine("Адрес за кореспонденция:                                                                      ");
            //sb.AppendLine("Адрес от данни за представляващия                                                             ");
            //sb.AppendLine("Град от данни за представляващия                                                              ");
            //sb.AppendLine("ПК от  данни за представляващия                                                               ");
            //sb.AppendLine("В качеството на                   (X) представляващ                   (х) пълномощник         ");
            //sb.AppendLine("					ако Представляващ е \"да\"	    ако Представляващ е \"не\"	                 ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("к1  --- номер по ред                                                                          ");
            //sb.AppendLine("к2  --- ЗДДС номер на контрагента от Дневник продажби (ако този номер не започва с BG)        ");
            //sb.AppendLine("к3  --- сделка ВОД от дневник продажби                                                        ");
            //sb.AppendLine("к4  --- сделка ПОСР от Дневник продажби                                                       ");
            //sb.AppendLine("к5  --- сделка ДРЧЛЕНКА от Дневник продажби                                                   ");
            //sb.AppendLine("к6  --- данъчният период от на декларацията (08/2014)                                         ");
            //sb.AppendLine("                                                                                              ");
            //sb.AppendLine("Долуподписаният: ----- Имена от данните на фирмата - данни за представляващия                 ");

            return sb.ToString();
        }
    }
}
